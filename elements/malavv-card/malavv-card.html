<dom-module id="malavv-card">

  <style>
    :host {
      @apply(--shadow-elevation-2dp);
      @apply(--layout-vertical);
      background-color: white;
      width: 330px;
      height: 200px;
      font-family: 'Roboto', sans-serif;
      font-weight: 400;
      color: #555;
    }

    :host div.title {
      text-align: center;
      font-size: 1.3em;
      border-bottom: 3px solid #BED89C;
    };

    :host div.summary {
      @apply(--layout-horizontal);
      font-size: 0.8em;
    };

    :host iron-pages {
      @apply(--layout-flex);
      overflow: hidden;
    };

    :host .footer {
      height: 30px;
      @apply(--layout-horizontal);
    }

    :host .footer .tags {
      @apply(--layout-flex);
      @apply(--layout-horizontal);
      overflow: hidden;
    }

    :host .footer .tags > div {
      padding: 3px;
      font-size: 10pt;
      margin-left: 5px;
    }

    :host .footer .cardType {
      width: 100px;
      font-size: 12px;
      color: #222;
      font-weight: bold;
    }
  </style>

  <template>
    <div class="title">{{card.title}}</div>
    <div class="summary">{{card.secondary}}</div>

    <iron-pages selected="{{toIndex(card.category)}}">
      <malavv-card-compet card="{{card}}"></malavv-card-compet>
      <malavv-card-education card="{{card}}"></malavv-card-education>
      <malavv-card-internship card="{{card}}"></malavv-card-internship>
      <malavv-card-project card="{{card}}"></malavv-card-project>
      <malavv-card-publications card="{{card}}"></malavv-card-publications>
      <malavv-card-starred card="{{card}}"></malavv-card-starred>
      <malavv-card-blog card="{{card}}"></malavv-card-blog>
      <malavv-card-club card="{{card}}"></malavv-card-club>
    </iron-pages>

    <div class="footer">
      <div class="tags">
        <template is="dom-repeat" items="{{card.tags}}">
          <div>{{item}}</div>
        </template>
      </div>
      <div class="cardType">{{toVisibleCategory(card.category)}}</div>
    </div>
  </template>

  <script>
    Polymer({
      is: 'malavv-card',
      properties: {
        card: {
          type: Object
        }
      },
      titleSizeThreshold: 24,
      toUrl: function(baseUrl) {
        return '../../img/' + baseUrl;
      },
      toDateString: function(date) {
        return new DateModel(date).toView();
      },
      fromSizeToClass: function(size) {
        return size <  this.titleSizeThreshold ? "normalSize" :
               size >= this.titleSizeThreshold ? "smallSize" :
               "";
      },
      cardChanged: function() {
        if (this.card.secondary === undefined || this.card.secondary === null || typeof(this.card.secondary) !== "string")
          throw new Error("Invalid Card Secondary Title");
        if (this.card.category === undefined || this.card.category === null || typeof(this.card.category) !== "string")
          throw new Error("Invalid Card Category");
      },
      toVisibleCategory: function(category) {
        switch (category) {
          case 'competition': return 'Competition';
          case 'education': return 'Education';
          case 'internship': return 'Internship';
          case 'project': return 'Pet Project';
          case 'publications': return 'Publications';
          case 'starredProject': return 'Starred Project';
          case 'blog': return 'Article';
          case 'club': return 'Club';
          default: return 'N/A';
        }
      },
      expand: function() {
        this.classList.add("hovered");
      },
      collapse: function() {
        this.classList.remove("hovered");
      },
      toIndex: function(category) {
        switch (category) {
          case 'competition': return 0;
          case 'education': return 1;
          case 'internship': return 2;
          case 'project': return 3;
          case 'publications': return 4;
          case 'starredProject': return 5;
          case 'blog': return 6;
          case 'club': return 7;
        }
      },
    });
  </script>

</dom-module>