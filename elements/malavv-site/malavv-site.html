<dom-module id="malavv-site">
  <style>
    :host {
      @apply(--layout-horizontal);
      font-family: 'RobotoDraft', sans-serif;
    }

    :host #cards {
      @apply(--layout-horizontal);
      @apply(--layout-flex);
      @apply(--layout-wrap); 
      
      background-color: #fafafa;
      overflow-y: scroll;
      position: relative;
      padding: 10px;
    }

    :host iron-pages {
      @apply(--layout-fit);
      overflow-y: hidden;
    }

    :host iron-pages div {
      @apply(--layout);
      height: 100%;
    }

    :host paper-material {
      z-index: 1;
      @apply(--layout-vertical);
    }

    :host iron-pages div malavv-infobar {
      @apply(--shadow-elevation-2dp);
      width: 310px;
      min-width: 310px; 
      z-index: 1;
    }
  </style>

  <template>
    <!-- Data for the website -->
    <iron-ajax auto 
      url="../../data/data.json"
      handle-as="json"
      last-response="{{data}}"></iron-ajax>
    
    <!-- Template Selector between website and manager. -->
    <iron-pages selected="{{selected}}">
      <div>
        <malavv-infobar></malavv-infobar>
        
        <div id="cards">
          <template is="dom-repeat" items="{{data.cards}}">
            <malavv-card card="{{item}}"></malavv-card>
          </template>
        </div>
      </div>
      <admin-manager cards="{{data.cards}}"></admin-manager>
    </iron-pages>

    <malavv-trigger trigger="{{editorTrigger}}" on-triggered="switchToEditor"></malavv-trigger>
  </template>

  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'malavv-site',
      
      properties: {
        data: {
          type: Object,
          notify: true
        },
        dataUrl: {
          type: String,
          value: window.config.data.url
        },
        editorTrigger: {
          type: Array,
          value: window.config.editor.activator
        },
        selected: {
          type: Number,
          value: 0
        }
      },
      switchToEditor: function() {
        console.info('Switched to editor mode.');
        this.selected = 1;
      }
    });

  })()
  </script>

</dom-module>