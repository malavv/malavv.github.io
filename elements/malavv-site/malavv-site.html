<dom-module id="malavv-site">
  <style>
    :host {
      @apply(--layout-horizontal);
      font-family: 'RobotoDraft', sans-serif;
    }

    :host #cards {
      /*@apply(--layout-horizontal);
      @apply(--layout-flex);
      @apply(--layout-wrap);*/ 
      @apply(--layout-flex);
      

    }
    :host #cards malavv-card {
      /*margin-bottom: 10px;
      margin-right: 10px;*/
    };

    :host paper-drawer-panel {
      overflow-y: scroll;
      position: relative;
      background-color: #fafafa;
      padding: 10px;
    };

    :host paper-material {
      z-index: 1;
      @apply(--layout-vertical);
    }

    :host malavv-infobar {
      @apply(--shadow-elevation-2dp);
      width: 310px;
      min-width: 310px; 
      z-index: 1;
    }
  </style>

  <template>
    <!-- Data for the website -->
    <iron-ajax auto 
      url="[[dataUrl]]"
      handle-as="json"
      last-response="{{data}}"></iron-ajax>

    <!-- Left Infobar -->
    <malavv-infobar img="[[infobarImg]]"></malavv-infobar>

    <!-- Grid of cards -->
    <paper-drawer-panel id="drawer" right-drawer force-narrow="true">
      <malavv-cards main id="cards" on-card-tap="cardTapHandler" cards="[[data.cards]]"></malavv-cards>
      <div id="test" drawer>Drawer</div>
    </paper-drawer-panel>
  </template>

  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'malavv-site',
      
      behaviors: [
        Polymer.NeonAnimatableBehavior,
        Polymer.NeonAnimationRunnerBehavior
      ],

      properties: {
        data: {
          type: Object,
          notify: true
        },
        dataUrl: {
          type: String,
          value: window.config.data.url
        },
        infobarImg: {
          type: String,
          value: window.config.me.mainImg
        },
        drawerModel: {
          type: Object,
          observer: 'drawerContentHandler'
        },


        animationConfig: {
          type: Object,
          value: function() {
            return {
              'entry': [{
                animatable: this.$.cards,
                type: 'entry'
              }]
            };
          }
        }
      },
      drawerContentHandler: function() {
        this.$.test.innerText = this.drawerModel.__data__.card.title;
      },
      cardTapHandler: function(event, detail, sender) {
        this.drawerModel = detail;
        this.$.drawer.openDrawer();
      },
      show: function() {
        this.$.drawer.closeDrawer();
        this.async(function() {
          this.playAnimation('entry');
        }, 1)
      }
    });

  })()
  </script>

</dom-module>